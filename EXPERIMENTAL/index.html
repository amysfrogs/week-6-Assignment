<!DOCTYPE html>
<html lang = "en">
    <head>
        <meta charset = "UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name = "viewport" content = "width = device-width, initial-scale = 1.0">
        <script src="../libs/d3.js"></script>
        <script src="https://d3js.org/topojson.v1.min.js"></script>
        <title>MA Counties</title>
        <style>
            body{
                text-align: center;
                margin: auto;
                font-family: sans-serif;
            }
            #tooltip {
                position: absolute;
                opacity: 0;
                top: 0;
                left: 0;
                width: auto;
                padding: 10px;
                background: white;
                font-family: sans-serif;
                font-size: medium;
                border-radius: 2px;
                line-height: 1;
            }
            path {
                stroke-width: 0;
                stroke: black;
            }
            path:hover {
                opacity: 0.6;
                stroke: black;
                stroke-width: 4px;
            }
            #details {
                position: absolute;
                margin: 10px;
                opacity: 0;
                top: 0;
                right: 0;
                width: 150px;
                height: auto;
                padding: 10px;
                background: azure;
                font-family: sans-serif;
                font-size: medium;
                border-radius: 2px;
                line-height: 1;
                border: 1px solid #000;
            }
            svg {
                margin: auto;
                width: 90%;
                padding: 10px;
                text-align: center;

            }

        </style>
    </head>

    <body>
    <div id = "tooltip"></div>
    <div id = "details"></div>
    <h1>
        Massachusetts Counties
    </h1>
    <h3>
        Amy Westell
    </h3>
    
    <script>
        //set page dimensions
        const page_dims = {
            width: window.innerWidth,
            height: window.innerHeight
        };
        const margin = page_dims.width * 0.2
        //create constant to store data location
        const MA_counties = "../data/towns.topojson"
        
        //open file
        Promise.all([
            d3.json(MA_counties)
        ]).then(data => {
            const topo_data = data[0];

            //convert topology data to geojson
            const geojson = topojson.feature(topo_data, topo_data.objects.ma);

            //create geoPath generator
            const geoPath_generator = d3.geoPath()
                .projection(d3.geoMercator()
                .fitSize([page_dims.width - margin, page_dims.height - margin], geojson))
            //color scaling
            var colorInterpolator = d3.interpolateRgbBasis(["blue","darkgreen", "purple","firebrick"])
            
            //linear scale
            let linearScale = d3.scaleLinear()
                .domain(d3.extent(geojson.features, (d) => {
                    return d['properties']['FIPS_STCO']
                }))

            //create groupings county level values
            columnsToSum = ["POP1980", "POP1990", "POP2000", "POP2010", "SUM_ACRES"];
            //let townsByCounty = d3.flatGroup(geojson.features, (d) => d['properties']['FIPS_STCO']);
            let popsByCounty = d3.rollup(geojson.features, 
                                        v => Object.fromEntries(columnsToSum.map(col => 
                                        [col, d3.sum(v, d => +d['properties'][col])])), 
                                                        d => d['properties']['FIPS_STCO']);
            
            //create tooltip
            const tooltip = d3.select("#tooltip");
            const details = d3.select("#details");
            //append SVG
                let svg = d3.select("body").append("svg")
                .attr("width", "100vw")
                .attr("height", "100vh");
                //add path for the boundaries
                //Barnstable 25001
                svg.selectAll("path")
                .data(geojson.features.filter(d => d['properties']['FIPS_STCO'] == 25001))
                .enter()
                .append("path")
                .attr("d", d => geoPath_generator(d))
                .attr("fill", d => colorInterpolator(linearScale(d['properties']['FIPS_STCO'])))
                .attr("class", "Barnstable")
                .on("mouseenter", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                            if(d['properties']['FIPS_STCO'] == '25001') {
                                return "yellow"
                            }
                            else { 
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }}) 
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    tooltip.html(d['properties']['TOWN'])
                        .style("left", m.clientX + "px")
                        .style("top", m.clientY + "px")
                    details.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    details.html("<div>County: </div>" + 
                                "<div>Barnstable</div>" +
                                "<div>Population in 1980:</div>" +
                                "<div>" + popsByCounty.get(25001)['POP1980'] + "</div>" +
                                "<div>Population in 2010:</div>" +
                                "<div>" + popsByCounty.get(25001)['POP2010'] + "</div>" 
                            
                    );
                })
                .on("mousemove", (m, d) => {
                    tooltip.style("opacity", 0.9)
                    details.style("opacity", 0.9)
                })
                .on("mouseout", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                            if(d['properties']['FIPS_STCO'] == '25001') {
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }})
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0)
                    details.transition()
                        .duration(200)
                        .style("opacity", 0)
                }),
                //Berkshire 25003
                svg.selectAll("path")
                .data(geojson.features.filter(d => d['properties']['FIPS_STCO'] == 25003))
                .enter()
                .append("path")
                .attr("d", d => geoPath_generator(d))
                .attr("fill", d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO'])))
                .attr("class", "Berkshire")
                .on("mouseenter", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                        if(d['properties']['FIPS_STCO'] == '25003') {
                                return "yellow"
                            }
                            else { 
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }}) 
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    tooltip.html(d['properties']['TOWN'])
                        .style("left", m.clientX + "px")
                        .style("top", m.clientY + "px")
                    details.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    details.html("<div>County: </div>" + 
                                "<div>Berkshire</div>" +
                                "<div>Population in 1980:</div>" +
                                "<div>" + popsByCounty.get(25003)['POP1980'] + "</div>" +
                                "<div>Population in 2010:</div>" +
                                "<div>" + popsByCounty.get(25003)['POP2010'] + "</div>" 
                            
                    );
                })
                .on("mousemove", (m, d) => {
                    tooltip.style("opacity", 0.9)
                    details.style("opacity", 0.9)
                })
                .on("mouseout", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                            if(d['properties']['FIPS_STCO'] == '25003') {
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }})
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0)
                    details.transition()
                        .duration(200)
                        .style("opacity", 0)
                }),
                //Bristol 25005
                svg.selectAll("path")
                .data(geojson.features.filter(d => d['properties']['FIPS_STCO'] == 25005))
                .enter()
                .append("path")
                .attr("d", d => geoPath_generator(d))
                .attr("fill",  d => colorInterpolator(linearScale(d['properties']['FIPS_STCO'])))
                .attr("class", "Bristol")
                .on("mouseenter", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                        if(d['properties']['FIPS_STCO'] == '25005') {
                                return "yellow"
                            }
                            else { 
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }}) 
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    tooltip.html(d['properties']['TOWN'])
                        .style("left", m.clientX + "px")
                        .style("top", m.clientY + "px")
                    details.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    details.html("<div>County: </div>" + 
                                "<div>Bristol</div>" +
                                "<div>Population in 1980:</div>" +
                                "<div>" + popsByCounty.get(25005)['POP1980'] + "</div>" +
                                "<div>Population in 2010:</div>" +
                                "<div>" + popsByCounty.get(25005)['POP2010'] + "</div>" 
                            
                    );
                })
                .on("mousemove", (m, d) => {
                    tooltip.style("opacity", 0.9)
                    details.style("opacity", 0.9)
                })
                .on("mouseout", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                            if(d['properties']['FIPS_STCO'] == '25005') {
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }})
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0)
                    details.transition()
                        .duration(200)
                        .style("opacity", 0)
                }),
                //Dukes 25007
                svg.selectAll("path")
                .data(geojson.features.filter(d => d['properties']['FIPS_STCO'] == 25007))
                .enter()
                .append("path")
                .attr("d", d => geoPath_generator(d))
                .attr("fill",  d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO'])))
                .attr("class", "Dukes")
                .on("mouseenter", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                        if(d['properties']['FIPS_STCO'] == '25007') {
                                return "yellow"
                            }
                            else { 
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }}) 
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    tooltip.html(d['properties']['TOWN'])
                        .style("left", m.clientX + "px")
                        .style("top", m.clientY + "px")
                    details.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    details.html("<div>County: </div>" + 
                                "<div>Dukes</div>" +
                                "<div>Population in 1980:</div>" +
                                "<div>" + popsByCounty.get(25007)['POP1980'] + "</div>" +
                                "<div>Population in 2010:</div>" +
                                "<div>" + popsByCounty.get(25007)['POP2010'] + "</div>" 
                            
                    );
                })
                .on("mousemove", (m, d) => {
                    tooltip.style("opacity", 0.9)
                    details.style("opacity", 0.9)
                })
                .on("mouseout", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                            if(d['properties']['FIPS_STCO'] == '25007') {
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }})
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0)
                    details.transition()
                        .duration(200)
                        .style("opacity", 0)
                }),
                //Essex 25009
                svg.selectAll("path")
                .data(geojson.features.filter(d => d['properties']['FIPS_STCO'] == 25009))
                .enter()
                .append("path")
                .attr("d", d => geoPath_generator(d))
                .attr("fill", d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO'])))
                .attr("class", "Essex")
                .on("mouseenter", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                        if(d['properties']['FIPS_STCO'] == '25009') {
                                return "yellow"
                            }
                            else { 
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }}) 
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    tooltip.html(d['properties']['TOWN'])
                        .style("left", m.clientX + "px")
                        .style("top", m.clientY + "px")
                    details.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    details.html("<div>County: </div>" + 
                                "<div>Essex</div>" +
                                "<div>Population in 1980:</div>" +
                                "<div>" + popsByCounty.get(25009)['POP1980'] + "</div>" +
                                "<div>Population in 2010:</div>" +
                                "<div>" + popsByCounty.get(25009)['POP2010'] + "</div>" 
                            
                    );
                })
                .on("mousemove", (m, d) => {
                    tooltip.style("opacity", 0.9)
                    details.style("opacity", 0.9)
                })
                .on("mouseout", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                            if(d['properties']['FIPS_STCO'] == '25009') {
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }})
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0)
                    details.transition()
                        .duration(200)
                        .style("opacity", 0)
                }),
                //Franklin 25011
                svg.selectAll("path")
                .data(geojson.features.filter(d => d['properties']['FIPS_STCO'] == 25011))
                .enter()
                .append("path")
                .attr("d", d => geoPath_generator(d))
                .attr("fill", d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO'])))
                .attr("class", "Franklin")
                .on("mouseenter", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                        if(d['properties']['FIPS_STCO'] == '25011') {
                                return "yellow"
                            }
                            else { 
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }}) 
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    tooltip.html(d['properties']['TOWN'])
                        .style("left", m.clientX + "px")
                        .style("top", m.clientY + "px")
                    details.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    details.html("<div>County: </div>" + 
                                "<div>Barnstable</div>" +
                                "<div>Population in 1980:</div>" +
                                "<div>" + popsByCounty.get(25011)['POP1980'] + "</div>" +
                                "<div>Population in 2010:</div>" +
                                "<div>" + popsByCounty.get(25011)['POP2010'] + "</div>" 
                            
                    );
                })
                .on("mousemove", (m, d) => {
                    tooltip.style("opacity", 0.9)
                    details.style("opacity", 0.9)
                })
                .on("mouseout", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                            if(d['properties']['FIPS_STCO'] == '25011') {
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }})
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0)
                    details.transition()
                        .duration(200)
                        .style("opacity", 0)
                }),
                //Hampden 25013
                svg.selectAll("path")
                .data(geojson.features.filter(d => d['properties']['FIPS_STCO'] == 25013))
                .enter()
                .append("path")
                .attr("d", d => geoPath_generator(d))
                .attr("fill", d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO'])))
                .attr("class", "Hampden")
                .on("mouseenter", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                        if(d['properties']['FIPS_STCO'] == '25013') {
                                return "yellow"
                            }
                            else { 
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }}) 
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    tooltip.html(d['properties']['TOWN'])
                        .style("left", m.clientX + "px")
                        .style("top", m.clientY + "px")
                    details.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    details.html("<div>County: </div>" + 
                                "<div>Hampden</div>" +
                                "<div>Population in 1980:</div>" +
                                "<div>" + popsByCounty.get(25013)['POP1980'] + "</div>" +
                                "<div>Population in 2010:</div>" +
                                "<div>" + popsByCounty.get(25013)['POP2010'] + "</div>" 
                            
                    );
                })
                .on("mousemove", (m, d) => {
                    tooltip.style("opacity", 0.9)
                    details.style("opacity", 0.9)
                })
                .on("mouseout", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                            if(d['properties']['FIPS_STCO'] == '25013') {
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }})
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0)
                    details.transition()
                        .duration(200)
                        .style("opacity", 0)
                }),
                //Hampshire 25015
                svg.selectAll("path")
                .data(geojson.features.filter(d => d['properties']['FIPS_STCO'] == 25015))
                .enter()
                .append("path")
                .attr("d", d => geoPath_generator(d))
                .attr("fill", d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO'])))
                .attr("class", "Hampshire")
                .on("mouseenter", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                        if(d['properties']['FIPS_STCO'] == '25015') {
                                return "yellow"
                            }
                            else { 
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }}) 
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    tooltip.html(d['properties']['TOWN'])
                        .style("left", m.clientX + "px")
                        .style("top", m.clientY + "px")
                    details.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    details.html("<div>County: </div>" + 
                                "<div>Hampshire</div>" +
                                "<div>Population in 1980:</div>" +
                                "<div>" + popsByCounty.get(25015)['POP1980'] + "</div>" +
                                "<div>Population in 2010:</div>" +
                                "<div>" + popsByCounty.get(25015)['POP2010'] + "</div>" 
                            
                    );
                })
                .on("mousemove", (m, d) => {
                    tooltip.style("opacity", 0.9)
                    details.style("opacity", 0.9)
                })
                .on("mouseout", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                            if(d['properties']['FIPS_STCO'] == '25015') {
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }})
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0)
                    details.transition()
                        .duration(200)
                        .style("opacity", 0)
                }),
                //Middlesex 25017
                svg.selectAll("path")
                .data(geojson.features.filter(d => d['properties']['FIPS_STCO'] == 25017))
                .enter()
                .append("path")
                .attr("d", d => geoPath_generator(d))
                .attr("fill", d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO'])))
                .attr("class", "Middlesex")
                .on("mouseenter", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                        if(d['properties']['FIPS_STCO'] == '25017') {
                                return "yellow"
                            }
                            else { 
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }}) 
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    tooltip.html(d['properties']['TOWN'])
                        .style("left", m.clientX + "px")
                        .style("top", m.clientY + "px")
                    details.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    details.html("<div>County: </div>" + 
                                "<div>Middlesex/div>" +
                                "<div>Population in 1980:</div>" +
                                "<div>" + popsByCounty.get(25017)['POP1980'] + "</div>" +
                                "<div>Population in 2010:</div>" +
                                "<div>" + popsByCounty.get(25017)['POP2010'] + "</div>" 
                            
                    );
                })
                .on("mousemove", (m, d) => {
                    tooltip.style("opacity", 0.9)
                    details.style("opacity", 0.9)
                })
                .on("mouseout", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                            if(d['properties']['FIPS_STCO'] == '25017') {
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }})
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0)
                    details.transition()
                        .duration(200)
                        .style("opacity", 0)
                }),
                //Nantucket 25019
                svg.selectAll("path")
                .data(geojson.features.filter(d => d['properties']['FIPS_STCO'] == 25019))
                .enter()
                .append("path")
                .attr("d", d => geoPath_generator(d))
                .attr("fill", d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO'])))
                .attr("class", "Nantucket")
                .on("mouseenter", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                        if(d['properties']['FIPS_STCO'] == '25019') {
                                return "yellow"
                            }
                            else { 
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }}) 
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    tooltip.html(d['properties']['TOWN'])
                        .style("left", m.clientX + "px")
                        .style("top", m.clientY + "px")
                    details.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    details.html("<div>County: </div>" + 
                                "<div>Barnstable</div>" +
                                "<div>Population in 1980:</div>" +
                                "<div>" + popsByCounty.get(25019)['POP1980'] + "</div>" +
                                "<div>Population in 2010:</div>" +
                                "<div>" + popsByCounty.get(25019)['POP2010'] + "</div>" 
                            
                    );
                })
                .on("mousemove", (m, d) => {
                    tooltip.style("opacity", 0.9)
                    details.style("opacity", 0.9)
                })
                .on("mouseout", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                            if(d['properties']['FIPS_STCO'] == '25019') {
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }})
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0)
                    details.transition()
                        .duration(200)
                        .style("opacity", 0)
                }),
                //Norfolk 25021
                svg.selectAll("path")
                .data(geojson.features.filter(d => d['properties']['FIPS_STCO'] == 25021))
                .enter()
                .append("path")
                .attr("d", d => geoPath_generator(d))
                .attr("fill", d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO'])))
                .attr("class", "Norfolk")
                .on("mouseenter", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                        if(d['properties']['FIPS_STCO'] == '25021') {
                                return "yellow"
                            }
                            else { 
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }}) 
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    tooltip.html(d['properties']['TOWN'])
                        .style("left", m.clientX + "px")
                        .style("top", m.clientY + "px")
                    details.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    details.html("<div>County: </div>" + 
                                "<div>Norfolk</div>" +
                                "<div>Population in 1980:</div>" +
                                "<div>" + popsByCounty.get(25021)['POP1980'] + "</div>" +
                                "<div>Population in 2010:</div>" +
                                "<div>" + popsByCounty.get(25021)['POP2010'] + "</div>" 
                            
                    );
                })
                .on("mousemove", (m, d) => {
                    tooltip.style("opacity", 0.9)
                    details.style("opacity", 0.9)
                })
                .on("mouseout", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                            if(d['properties']['FIPS_STCO'] == '25021') {
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }})
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0)
                    details.transition()
                        .duration(200)
                        .style("opacity", 0)
                }),
                //Plymouth 25023
                svg.selectAll("path")
                .data(geojson.features.filter(d => d['properties']['FIPS_STCO'] == 25023))
                .enter()
                .append("path")
                .attr("d", d => geoPath_generator(d))
                .attr("fill", d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO'])))
                .attr("class", "Plymouth")
                .on("mouseenter", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                        if(d['properties']['FIPS_STCO'] == '25023') {
                                return "yellow"
                            }
                            else { 
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }}) 
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    tooltip.html(d['properties']['TOWN'])
                        .style("left", m.clientX + "px")
                        .style("top", m.clientY + "px")
                    details.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    details.html("<div>County: </div>" + 
                                "<div>Plymouth</div>" +
                                "<div>Population in 1980:</div>" +
                                "<div>" + popsByCounty.get(25023)['POP1980'] + "</div>" +
                                "<div>Population in 2010:</div>" +
                                "<div>" + popsByCounty.get(25023)['POP2010'] + "</div>" 
                            
                    );
                })
                .on("mousemove", (m, d) => {
                    tooltip.style("opacity", 0.9)
                    details.style("opacity", 0.9)
                })
                .on("mouseout", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                            if(d['properties']['FIPS_STCO'] == '25023') {
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }})
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0)
                    details.transition()
                        .duration(200)
                        .style("opacity", 0)
                }),
                //Suffolk 25025
                svg.selectAll("path")
                .data(geojson.features.filter(d => d['properties']['FIPS_STCO'] == 25025))
                .enter()
                .append("path")
                .attr("d", d => geoPath_generator(d))
                .attr("fill", d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO'])))
                .attr("class", "Suffolk")
                .on("mouseenter", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                        if(d['properties']['FIPS_STCO'] == '25025') {
                                return "yellow"
                            }
                            else { 
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }}) 
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    tooltip.html(d['properties']['TOWN'])
                        .style("left", m.clientX + "px")
                        .style("top", m.clientY + "px")
                    details.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    details.html("<div>County: </div>" + 
                                "<div>Barnstable</div>" +
                                "<div>Population in 1980:</div>" +
                                "<div>" + popsByCounty.get(25025)['POP1980'] + "</div>" +
                                "<div>Population in 2010:</div>" +
                                "<div>" + popsByCounty.get(25025)['POP2010'] + "</div>" 
                            
                    );
                })
                .on("mousemove", (m, d) => {
                    tooltip.style("opacity", 0.9)
                    details.style("opacity", 0.9)
                })
                .on("mouseout", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                            if(d['properties']['FIPS_STCO'] == '25024') {
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }})
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0)
                    details.transition()
                        .duration(200)
                        .style("opacity", 0)
                }),
                //Worcester 25027
                svg.selectAll("path")
                .data(geojson.features.filter(d => d['properties']['FIPS_STCO'] == 25027))
                .enter()
                .append("path")
                .attr("d", d => geoPath_generator(d))
                .attr("fill", d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO'])))
                .attr("class", "Worcester")
                .on("mouseenter", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                        if(d['properties']['FIPS_STCO'] == '25027') {
                                return "yellow"
                            }
                            else { 
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }}) 
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    tooltip.html(d['properties']['TOWN'])
                        .style("left", m.clientX + "px")
                        .style("top", m.clientY + "px")
                    details.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    details.html("<div>County: </div>" + 
                                "<div>Worcester</div>" +
                                "<div>Population in 1980:</div>" +
                                "<div>" + popsByCounty.get(25027)['POP1980'] + "</div>" +
                                "<div>Population in 2010:</div>" +
                                "<div>" + popsByCounty.get(25027)['POP2010'] + "</div>" 
                            
                    );
                })
                .on("mousemove", (m, d) => {
                    tooltip.style("opacity", 0.9)
                    details.style("opacity", 0.9)
                })
                .on("mouseout", (m, d) => {
                    d3.selectAll("path").attr("fill", d => {                        
                            if(d['properties']['FIPS_STCO'] == '25027') {
                                return d =>colorInterpolator(linearScale(d['properties']['FIPS_STCO']))
                            }})
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0)
                    details.transition()
                        .duration(200)
                        .style("opacity", 0)
                }),
                svg.selectAll("path")
                .data(geojson.features)
                .enter()
                .append("path")
                .attr("d", d => geoPath_generator(d))
                .attr("fill", d => colorInterpolator(linearScale(d['properties']['FIPS_STCO'])))
                .on("mouseenter", (m, d) => {
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    tooltip.html(d['properties']['TOWN'])
                        .style("left", m.clientX + "px")
                        .style("top", m.clientY + "px")
                    details.transition()
                        .duration(200)
                        .style("opacity", 0.9)
                    details.html("<div>Town: </div>" + 
                                "<div>" + d['properties']['TOWN'] + "</div>" +
                                "<div>Population: </div>" + 
                                "<div>" + d['properties']['POP1980'] + "</div>"  
                    );
                })
                .on("mousemove", (m, d) => {
                    tooltip.style("opacity", 0.9)
                    details.style("opacity", 0.9)
                })
                .on("mouseout", (m, d) => {
                    tooltip.transition()
                        .duration(200)
                        .style("opacity", 0)
                    details.transition()
                        .duration(200)
                        .style("opacity", 0)
                })
               
        })
    </script>
    </body>
</html>